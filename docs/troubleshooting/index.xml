<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Troubleshooting Guides on KubeFleet</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/</link><description>Recent content in Troubleshooting Guides on KubeFleet</description><generator>Hugo</generator><language>en</language><atom:link href="https://kubefleet-dev.github.io/website/docs/troubleshooting/index.xml" rel="self" type="application/rss+xml"/><item><title>ClusterResourcePlacement TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacement/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacement/</guid><description>&lt;p>This TSG is meant to help you troubleshoot issues with the ClusterResourcePlacement API in Fleet.&lt;/p>
&lt;h2 id="cluster-resource-placement">Cluster Resource Placement&lt;/h2>
&lt;p>Internal Objects to keep in mind when troubleshooting CRP related errors on the hub cluster:&lt;/p>
&lt;ul>
&lt;li>&lt;code>ClusterResourceSnapshot&lt;/code>&lt;/li>
&lt;li>&lt;code>ClusterSchedulingPolicySnapshot&lt;/code>&lt;/li>
&lt;li>&lt;code>ClusterResourceBinding&lt;/code>&lt;/li>
&lt;li>&lt;code>Work&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Please read the &lt;a href="https://kubefleet-dev.github.io/website/docs/api-reference/">Fleet API reference&lt;/a> for more details about each object.&lt;/p>
&lt;h2 id="complete-progress-of-the-clusterresourceplacement">Complete Progress of the ClusterResourcePlacement&lt;/h2>
&lt;p>Understanding the progression and the status of the &lt;code>ClusterResourcePlacement&lt;/code> custom resource is crucial for diagnosing and identifying failures.
You can view the status of the &lt;code>ClusterResourcePlacement&lt;/code> custom resource by using the following command:&lt;/p></description></item><item><title>CRP Schedule Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementscheduled/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementscheduled/</guid><description>&lt;p>The &lt;code>ClusterResourcePlacementScheduled&lt;/code> condition is set to &lt;code>false&lt;/code> when the scheduler cannot find all the clusters needed as specified by the scheduling policy.&lt;/p>
&lt;blockquote>
&lt;p>Note: To get more information about why the scheduling fails, you can check the &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/scheduler/scheduler.go">scheduler&lt;/a> logs.&lt;/p>&lt;/blockquote>
&lt;h2 id="common-scenarios">Common scenarios&lt;/h2>
&lt;p>Instances where this condition may arise:&lt;/p>
&lt;ul>
&lt;li>When the placement policy is set to &lt;code>PickFixed&lt;/code>, but the specified cluster names do not match any joined member cluster name in the fleet, or the specified cluster is no longer connected to the fleet.&lt;/li>
&lt;li>When the placement policy is set to &lt;code>PickN&lt;/code>, and N clusters are specified, but there are fewer than N clusters that have joined the fleet or satisfy the placement policy.&lt;/li>
&lt;li>When the &lt;code>ClusterResourcePlacement&lt;/code> resource selector selects a reserved namespace.&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>Note: When the placement policy is set to &lt;code>PickAll&lt;/code>, the &lt;code>ClusterResourcePlacementScheduled&lt;/code> condition is always set to &lt;code>true&lt;/code>.&lt;/p></description></item><item><title>CRP Rollout Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementrolloutstarted/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementrolloutstarted/</guid><description>&lt;p>When using the &lt;code>ClusterResourcePlacement&lt;/code> API object in Azure Kubernetes Fleet Manager to propagate resources, the selected resources aren&amp;rsquo;t rolled out in all scheduled clusters and the &lt;code>ClusterResourcePlacementRolloutStarted&lt;/code> condition status shows as &lt;code>False&lt;/code>.&lt;/p>
&lt;p>&lt;em>This TSG only applies to the &lt;code>RollingUpdate&lt;/code> rollout strategy, which is the default strategy if you don&amp;rsquo;t specify in the &lt;code>ClusterResourcePlacement&lt;/code>.&lt;/em>
&lt;em>To troubleshoot the update run strategy as you specify &lt;code>External&lt;/code> in the &lt;code>ClusterResourcePlacement&lt;/code>, please refer to the &lt;a href="https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterstagedupdaterun/">Staged Update Run Troubleshooting Guide&lt;/a>.&lt;/em>&lt;/p></description></item><item><title>CRP Override Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementoverridden/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementoverridden/</guid><description>&lt;p>The status of the &lt;code>ClusterResourcePlacementOverridden&lt;/code> condition is set to &lt;code>false&lt;/code> when there is an Override API related issue.&lt;/p>
&lt;blockquote>
&lt;p>Note: To get more information, look into the logs for the overrider controller (includes
controller for &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/overrider/clusterresource_controller.go">ClusterResourceOverride&lt;/a> and
&lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/overrider/resource_controller.go">ResourceOverride&lt;/a>).&lt;/p>&lt;/blockquote>
&lt;h2 id="common-scenarios">Common scenarios&lt;/h2>
&lt;p>Instances where this condition may arise:&lt;/p>
&lt;ul>
&lt;li>The &lt;code>ClusterResourceOverride&lt;/code> or &lt;code>ResourceOverride&lt;/code> is created with an invalid field path for the resource.&lt;/li>
&lt;/ul>
&lt;h2 id="case-study">Case Study&lt;/h2>
&lt;p>In the following example, an attempt is made to override the cluster role &lt;code>secret-reader&lt;/code> that is being propagated by the &lt;code>ClusterResourcePlacement&lt;/code> to the selected clusters.
However, the &lt;code>ClusterResourceOverride&lt;/code> is created with an invalid path for the field within resource.&lt;/p></description></item><item><title>CRP Work-Synchronization Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementworksynchronized/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementworksynchronized/</guid><description>&lt;p>The &lt;code>ClusterResourcePlacementWorkSynchronized&lt;/code> condition is false when the CRP has been recently updated but the associated work objects have not yet been synchronized with the changes.&lt;/p>
&lt;blockquote>
&lt;p>Note: In addition, it may be helpful to look into the logs for the &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/workgenerator/controller.go">work generator controller&lt;/a> to get more information on why the work synchronization failed.&lt;/p>&lt;/blockquote>
&lt;h2 id="common-scenarios">Common Scenarios&lt;/h2>
&lt;p>Instances where this condition may arise:&lt;/p>
&lt;ul>
&lt;li>The controller encounters an error while trying to generate the corresponding &lt;code>work&lt;/code> object.&lt;/li>
&lt;li>The enveloped object is not well formatted.&lt;/li>
&lt;/ul>
&lt;h3 id="case-study">Case Study&lt;/h3>
&lt;p>The CRP is attempting to propagate a resource to a selected cluster, but the work object has not been updated to reflect the latest changes due to the selected cluster has been terminated.&lt;/p></description></item><item><title>CRP Work-Application Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementapplied/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementapplied/</guid><description>&lt;p>The &lt;code>ClusterResourcePlacementApplied&lt;/code> condition is set to &lt;code>false&lt;/code> when the deployment fails.&lt;/p>
&lt;blockquote>
&lt;p>Note: To get more information about why the resources are not applied, you can check the &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/work/apply_controller.go">apply work controller&lt;/a> logs.&lt;/p>&lt;/blockquote>
&lt;h2 id="common-scenarios">Common scenarios&lt;/h2>
&lt;p>Instances where this condition may arise:&lt;/p>
&lt;ul>
&lt;li>The resource already exists on the cluster and isn&amp;rsquo;t managed by the fleet controller.&lt;/li>
&lt;li>Another &lt;code>ClusterResourcePlacement&lt;/code> deployment is already managing the resource for the selected cluster by using a different apply strategy.&lt;/li>
&lt;li>The &lt;code>ClusterResourcePlacement&lt;/code> deployment doesn&amp;rsquo;t apply the manifest because of syntax errors or invalid resource configurations. This might also occur if a resource is propagated through an envelope object.&lt;/li>
&lt;/ul>
&lt;h2 id="investigation-steps">Investigation steps&lt;/h2>
&lt;ol>
&lt;li>Check &lt;code>placementStatuses&lt;/code>: In the &lt;code>ClusterResourcePlacement&lt;/code> status section, inspect the &lt;code>placementStatuses&lt;/code> to identify which clusters have the &lt;code>ResourceApplied&lt;/code> condition set to &lt;code>false&lt;/code> and note down their &lt;code>clusterName&lt;/code>.&lt;/li>
&lt;li>Locate the &lt;code>Work&lt;/code> Object in Hub Cluster: Use the identified &lt;code>clusterName&lt;/code> to locate the &lt;code>Work&lt;/code> object associated with the member cluster. Please refer to this &lt;a href="https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacement/#how-can-i-find-the-correct-work-resource-thats-associated-with-clusterresourceplacement">section&lt;/a> to learn how to get the correct &lt;code>Work&lt;/code> resource.&lt;/li>
&lt;li>Check &lt;code>Work&lt;/code> object status: Inspect the status of the &lt;code>Work&lt;/code> object to understand the specific issues preventing successful resource application.&lt;/li>
&lt;/ol>
&lt;h2 id="case-study">Case Study&lt;/h2>
&lt;p>In the following example, &lt;code>ClusterResourcePlacement&lt;/code> is trying to propagate a namespace that contains a deployment to two member clusters. However, the namespace already exists on one member cluster, specifically &lt;code>kind-cluster-1&lt;/code>.&lt;/p></description></item><item><title>CRP Availability Failure TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementavailable/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementavailable/</guid><description>&lt;p>The &lt;code>ClusterResourcePlacementAvailable&lt;/code> condition is &lt;code>false&lt;/code> when some of the resources are not available yet. We will place some of the detailed failure in the &lt;code>FailedResourcePlacement&lt;/code> array.&lt;/p>
&lt;blockquote>
&lt;p>Note: To get more information about why resources are unavailable check &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/work/apply_controller.go">apply work controller&lt;/a> logs.&lt;/p>&lt;/blockquote>
&lt;h2 id="common-scenarios">Common scenarios&lt;/h2>
&lt;p>Instances where this condition may arise:&lt;/p>
&lt;ul>
&lt;li>The member cluster doesn&amp;rsquo;t have enough resource availability.&lt;/li>
&lt;li>The deployment contains an invalid image name.&lt;/li>
&lt;/ul>
&lt;h2 id="case-study">Case Study&lt;/h2>
&lt;p>The example output below demonstrates a scenario where the CRP is unable to propagate a deployment to a member cluster due to the deployment having a bad image name.&lt;/p></description></item><item><title>ClusterResourcePlacementEviction TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementeviction/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterresourceplacementeviction/</guid><description>&lt;p>This guide provides troubleshooting steps for issues related to placement eviction.&lt;/p>
&lt;p>An eviction object when created is ideally only reconciled once and reaches a terminal state. List of terminal states
for eviction are:&lt;/p>
&lt;ul>
&lt;li>Eviction is Invalid&lt;/li>
&lt;li>Eviction is Valid, Eviction failed to Execute&lt;/li>
&lt;li>Eviction is Valid, Eviction executed successfully&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>&lt;strong>Note:&lt;/strong> If an eviction object doesn&amp;rsquo;t reach a terminal state i.e. neither valid condition nor executed condition is
set it is likely due to a failure in the reconciliation process where the controller is unable to reach the api server.&lt;/p></description></item><item><title>ClusterStagedUpdateRun TSG</title><link>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterstagedupdaterun/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kubefleet-dev.github.io/website/docs/troubleshooting/clusterstagedupdaterun/</guid><description>&lt;p>This guide provides troubleshooting steps for common issues related to Staged Update Run.&lt;/p>
&lt;blockquote>
&lt;p>Note: To get more information about why the scheduling fails, you can check the &lt;a href="https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/updaterun/controller.go">updateRun controller&lt;/a> logs.&lt;/p>&lt;/blockquote>
&lt;h2 id="crp-status-without-staged-update-run">CRP status without Staged Update Run&lt;/h2>
&lt;p>When a &lt;code>ClusterResourcePlacement&lt;/code> is created with &lt;code>spec.strategy.type&lt;/code> set to &lt;code>External&lt;/code>, the rollout does not start immediately.&lt;/p>
&lt;p>A sample status of such &lt;code>ClusterResourcePlacement&lt;/code> is as follows:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ kubectl describe crp example-placement
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Status:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Conditions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: found all cluster needed as specified by the scheduling policy, found &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> cluster&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>s&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: SchedulingPolicyFulfilled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: True
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: ClusterResourcePlacementScheduled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: There are still &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> cluster&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>s&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span> in the process of deciding whether to roll out the latest resources or not
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: RolloutStartedUnknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: Unknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: ClusterResourcePlacementRolloutStarted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Resource Index: &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Placement Statuses:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Cluster Name: member1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Conditions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: Successfully scheduled resources &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> placement in &lt;span style="color:#4e9a06">&amp;#34;member1&amp;#34;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>affinity score: 0, topology spread score: 0&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>: picked by scheduling policy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: Scheduled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: True
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: Scheduled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: In the process of deciding whether to roll out the latest resources or not
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: RolloutStartedUnknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: Unknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: RolloutStarted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Cluster Name: member2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Conditions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: Successfully scheduled resources &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> placement in &lt;span style="color:#4e9a06">&amp;#34;member2&amp;#34;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>affinity score: 0, topology spread score: 0&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>: picked by scheduling policy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: Scheduled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: True
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: Scheduled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Last Transition Time: 2025-03-12T23:01:32Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message: In the process of deciding whether to roll out the latest resources or not
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Observed Generation: &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Reason: RolloutStartedUnknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: Unknown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: RolloutStarted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Selected Resources:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Events: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SchedulingPolicyFulfilled&lt;/code> condition indicates the CRP has been fully scheduled, while &lt;code>RolloutStartedUnknown&lt;/code> condition shows that the rollout has not started.&lt;/p></description></item></channel></rss>